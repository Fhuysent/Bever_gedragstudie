#Resultaten

##Inventarisatie {#h:inventarisatieres}

### April 2017

Tijdens de eerste inventarisatie op 19 april 2017 werden `r dim(InventApril)[1]` locaties met sporen aangetroffen (getypeerd als `r table(InventApril$Type)[1]` `r names(table(InventApril$Type)[1])`, `r table(InventApril$Type)[2]` `r names(table(InventApril$Type)[2])` en `r table(InventApril$Type)[3]` `r names(table(InventApril$Type)[3])`).
Zoals te zien in Fig. \@ref(fig:kaartapril), waren deze sporen verdeeld in drie verschillende clusters. Een eerste cluster bevond zich tussen Werchter en Haacht waar `r length(InventApril$Waarneming[InventApril$lon>4.644])` van de `r dim(InventApril)[1]` sporen werden gevonden, waaronder `r length(InventApril$Waarneming[InventApril$lon>4.644 & InventApril$Type=="hol"])` van de `r table(InventApril$Type)[2]` holen en `r length(InventApril$Waarneming[InventApril$lon>4.644 & InventApril$Type=="dagrustplaats"])` van de `r table(InventApril$Type)[1]` dagrustplaatsen. In een tweede zone, gelegen tussen Haacht en Rijmenam, werden `r length(InventApril$Waarneming[InventApril$lon<4.644 & InventApril$lon>4.586])` sporen gevonden, waarvan `r length(InventApril$Waarneming[InventApril$lon<4.644 & InventApril$lon>4.586 & InventApril$Type == "hol"])` van de `r table(InventApril$Type)[2]` holen en `r length(InventApril$Waarneming[InventApril$lon<4.644 & InventApril$lon>4.586 & InventApril$Type == "dagrustplaats"])` van de`r table(InventApril$Type)[1]` dagrustplaatsen. In een laatste zone, tussen Rijmenam en Muizen werden nog `r length(InventApril$Waarneming[InventApril$lon<4.586])` van de `r dim(InventApril)[1]` sporen gevonden, allemaal wissels.

```{r, kaartkleurenapril, include=FALSE}
pal <- colorFactor(
  palette = c('green','red','blue'),
  domain = InventApril$Type
  
)
```

```{r kaartapril, fig.cap="Waargenomen sporen tijdens oeverinspectie op 17 april 2017.", echo=FALSE}
leaflet(data=InventApril) %>% 
  addTiles() %>%
  addCircleMarkers(~lon,~lat, color=~pal(Type), stroke = F, radius=10, fillOpacity = 0.8) %>%
  addLegend("bottomright", pal = pal, values = ~Type,
    title = "Spoortypes",
    opacity = 1)
```
### Augustus 2017

De inventarisatie op 30 augustus 2017 leverde `r dim(InventAug)[1]` locaties met sporen op (getypeerd als `r table(InventAug$Type)[1]` `r names(table(InventAug$Type)[1])`, `r table(InventAug$Type)[2]` `r names(table(InventAug$Type)[2])` en `r table(InventAug$Type)[3]` `r names(table(InventAug$Type)[3])`). Deze aantallen zijn sterk vergelijkbaar met de inventarisatie in April 2017, enkel het aantal dagrustplaatsen lag iets lager. Dit kan echter een effect zijn van hogere vegetatie die het vinden van dit soort sporen in deze periode moeilijker maakt. 
Zoals te zien in Fig. \@ref(fig:kaartaugustus), waren deze sporen opnieuw verdeeld in drie verschillende clusters, maar zijn er toch wat verschuivingen in vergelijking met April. Wanneer we dezelfde clusterafbakening hanteren als in april, lagen  `r length(InventAug$Waarneming[InventAug$lon>4.644])` van de `r dim(InventAug)[1]` sporen in de cluster Werchter-Haacht, waarvan `r length(InventAug$Waarneming[InventAug$lon>4.644 & InventAug$Type=="hol"])` van de `r table(InventAug$Type)[2]` holen en `r length(InventAug$Waarneming[InventAug$lon>4.644 & InventAug$Type=="dagrustplaats"])` van de `r table(InventAug$Type)[1]` dagrustplaatsen. In de tweede zone, tussen Haacht en Rijmenam, werden `r length(InventAug$Waarneming[InventAug$lon<4.644 & InventAug$lon>4.586])` sporen gevonden, waarvan `r length(InventAug$Waarneming[InventAug$lon<4.644 & InventAug$lon>4.586 & InventAug$Type == "hol"])` van de `r table(InventAug$Type)[2]` holen en `r length(InventAug$Waarneming[InventAug$lon<4.644 & InventAug$lon>4.586 & InventAug$Type == "dagrustplaats"])` van de `r table(InventAug$Type)[1]` dagrustplaatsen. In de laatste zone, tussen Rijmenam en Muizen werden opnieuw enkel wissels waargenomen, goed voor `r length(InventAug$Waarneming[InventAug$lon<4.586])` van de `r dim(InventApril)[1]` sporen.

```{r, kaartkleurenaugustus, include=FALSE}
pal <- colorFactor(
  palette = c('green','red','blue'),
  domain = InventAug$Type
)
```

```{r kaartaugustus, fig.cap="Waargenomen sporen tijdens oeverinspectie op 30 augustus 2017.", echo=FALSE}
leaflet(data=InventAug) %>% 
  addTiles() %>%
  addCircleMarkers(~lon,~lat, color=~pal(Type), stroke = F, radius=10, fillOpacity = 0.8) %>%
  addLegend("bottomright", pal = pal, values = ~Type,
    title = "Spoortypes",
    opacity = 1)
```

##Telemetrie {#h:telemetrieres}

###Vangen en zenderen {#h:vangenzenderen}

Zoals vermeld onder \@ref(h:vangenmm), werden tijdens een eerste proefperiode in 2017 vier bevers gevangen om het vangen, zenderen en opvolgen via telemetrie te testen. De gegevens van twee van deze bevers bleken niet bruikbaar voor verdere verwerking. Beide andere bevers leverden wel al direct bruikbare data op. Samen met de bevers gevangen in de daaropvolgende vangstsessies werden over de ganse projectperiode in totaal `r length(unique(levels(Bevers$Bever)))` verschillende bevers gevangen, waarvan er `r length(unique(levels(Zenderbevers$Bever)))` met een zender werden uitgerust (tabel \@ref(tab:tabZenderbevers)). In de laatste sessie werd immers, door een gelimiteerd aantal zenders dat nog ter beschikking was, geopteerd om niet alle bevers te zenderen. Bevers die niet werden gezenderd werden wel van een staarttag met identificatiecode en een onderhuidse PIT-tag voor identificatie voorzien.

```{r tabZenderbevers, echo=FALSE}
Laatste <- Waarnemingen[,-c(2)] %>% 
  group_by(Bever) %>%
  summarise(Laatste = max(Datumkort, na.rm=T)) %>% 
  mutate(Laatste = as.Date(Laatste, format="%d/%m/%Y"))
Datapunten <- Telemetrie[,-c(1)] %>% 
  group_by(Bever) %>%
  summarise(Aantal = length(unique(Date)))
Zendertabel <- merge(Zenderbevers[,c(1,9,20)],Laatste, by="Bever")
Zendertabel <- merge(Zendertabel, Datapunten, by="Bever", all.x=T)
Zendertabel$Vangstdatum <- as.Date(Zendertabel$Vangstdatum, format="%d/%m/%Y")
Zendertabel <- Zendertabel %>% 
  mutate(tijd = Laatste-Vangstdatum)
Zendertabel2 <- Zendertabel %>%
  group_by(Bever) %>%
  summarise(Start = min(Vangstdatum), Laatste = max(Laatste), dagen = max(tijd), Aantal = max(Aantal))
Zendertabel <- merge(Zendertabel2, Afstanden, by="Bever") %>% 
  mutate(Afstand = round(maxdist/1000, digits=1)) %>% 
  mutate(dagen = as.numeric(dagen)+1) %>% 
  mutate(Start = as.character(Start, format="%d/%m/%Y")) %>% 
  mutate(Laatste = as.character(Laatste, format="%d/%m/%Y")) %>% 
  mutate(Aantal = replace_na(Aantal, 0))
kable(Zendertabel[,-c(6)],
  caption = "Overzicht dataverzameling gezenderde bevers.",
  col.names = c("Bever", "Startdatum", "Laatste datum","Aantal dagen","Aantal datapunten", "Max. afstand")
 )
```

Bevers met een zender konden gemiddeld `r round(mean(Zendertabel$dagen), digits=0)` dagen worden opgevolgd, variërend van `r min(Zendertabel$dagen)` tot `r max(Zendertabel$dagen)`. Dit leverde gemiddeld  `r round(mean(Zendertabel$Aantal), digits=0)` (`r min(Zendertabel$Aantal)`-`r max(Zendertabel$Aantal)`) datapunten per bever op. Dit betekent dat gemiddeld elke `r Zendertabel %>% mutate(opbrengst = Aantal/dagen) %>% summarise(effectiviteit = round(1/mean(opbrengst),digits=1))` dagen een localisatie kon worden bepaald.

Al deze gegevens zijn informatief maar voor de gedetailleerde verwerking wordt enkel gebruik gemaakt van gegevens van bevers die voldoende gegevens opleverden. Omdat de gegevens verder per maand zullen worden geanalyseerd werd ervoor geopteerd om voor deze detailanalyses enkel die bevers te weerhouden die minstens een volledige maand konden worden opgevolgd. Gezien het gemiddelde van `r Zendertabel %>% mutate(opbrengst = Aantal/dagen) %>% summarise(effectiviteit = round(1/mean(opbrengst),digits=1))` dagen tussen twee localisaties, werd daarbij geopteerd om ook een minimum van 10 verzamelde datapunten als ondergrens voor gedetailleerde verwerking te hanteren.

Dit zorgde ervoor dat `r length(Zendertabel$Bever[Zendertabel$Aantal>9 & Zendertabel$dagen>30])` van de `r length(unique(levels(Zenderbevers$Bever)))` gezenderde bevers geschikt waren voor detailanalyse. Tabel \@ref(tab:tabZenderbevers) leert dat van de 
`r length(unique(levels(Zenderbevers$Bever))) - (length(Zendertabel$Bever[Zendertabel$Aantal>9 & Zendertabel$dagen>30]))` 
er
`r length(Zendertabel$Bever[Zendertabel$Aantal<6])` zelfs vijf of minder datapunten hadden opgeleverd. Verder toont tabel \@ref(tab:tabZenderbevers) dat door het verwijderen van deze bevers ook de extreme waarden in maximaal waargenomen afstand tussen twee punten werden verwijderd. Dit is logischerwijs het gevolg voor de bevers die geen data opleverden maar zorgt er ook voor dat de twee hoogst vastgestelde afstanden uit de dataset verdwijnen. Dit zorgt er in zijn geheel voor dat de gemiddelde afstand van `r round(mean(Zendertabel$maxdist)/1000,digits=2)` ± `r round(sd(Zendertabel$maxdist)/1000,digits=2)` km voor de volledige dataset wordt bijgesteld tot `r round(mean(Zendertabel$maxdist[Zendertabel$dagen>30 & Zendertabel$Aantal>9])/1000,digits=2)` ± `r round(sd(Zendertabel$maxdist[Zendertabel$dagen>30 & Zendertabel$Aantal>9])/1000,digits=2)` km.

##Analyse {#h:analyse}

###Berekening home ranges {#h:MCPanalyses}

```{r berekening MCP home ranges, echo=FALSE}
Databevers <- Zendertabel$Bever[Zendertabel$dagen>30 & Zendertabel$Aantal >10] %>% 
  droplevels()

HRdata <- Waarnemingen %>% 
  filter(Bever %in% Databevers) %>% 
  droplevels()

coordinates(HRdata) <- c("lon","lat")
proj4string(HRdata) <- CRS(WGS84)

##toevoegen welke punten in welke meander liggen
HRdata$polygon_id = over(HRdata, MeandersPoly, returnlist = T)

##plot in WGS84
plotMCP95 <- mcp(HRdata[,1], percent=95, unin = "m", unout = "ha")

HRdata2 <- spTransform(HRdata, BEL)

##95%MCP
##om een nog niet duidelijke reden geeft enkel km input en m2 output de juiste output in ha
cp <- mcp(HRdata2[,1], percent=95, unin = "m", unout = "ha")

##Oppervlakten
Oppervlaktes  <- as.data.frame(cp)
```
```{r Kleurenpalet instellen}
colourCount = length(unique(HRdata@data$Bever))
getPalette = colorRampPalette(brewer.pal(9, "Set1"))
pal <- colorFactor(getPalette(colourCount), domain = HRdata@data$Bever)
``` 
```{r Figruwedata,fig.cap="Verzamelde locatiegegevens voor elk van de 14 bevers met geschikte data.", echo=FALSE}
leaflet(HRdata)%>%
addTiles()%>%
addCircleMarkers(color=~pal(Bever), radius=5, fillOpacity = 0.5, stroke = F)
```

```{r Figpercentage, fig.cap="Verandering in home range grootte bij variërende percentages van het aantal locaties gebruikt bij het bepalen van minimum convex polygonen voor de 14 bevers met geschikte data.", echo=FALSE}
plotdata <- as.data.frame(melt(mcp.area(HRdata2[,1], percent=seq(50, 100, by = 5))))
plotdata$percentage <- rep(seq(50,100,5),length(unique(plotdata$variable)))
ggplot(data= plotdata) +
  geom_line(aes(x=percentage, y=value, group=variable)) + 
  xlab("percentage locaties gebruikt") +
  ylab("Oppervlakte (ha)")
```

```{r FigMCPkaart, fig.cap="Home ranges voor de 14 bevers met geschikte data, berekend via MCP.", echo=FALSE}
leaflet()%>%
  addTiles()%>%
  addPolygons(data=plotMCP95, color=~pal(id), fillOpacity = 1, stroke = F)
```

```{r ClipRivieren}
Rivierlengtes <- data.frame(Bever=levels(HRdata$Bever),
                            Lengte=rep(0,length(levels(HRdata$Bever))))

for (i in levels(HRdata$Bever)){
  locs <- subset(HRdata, Bever==i)
  x_coord <- c(max(locs$lon),max(locs$lon),min(locs$lon),min(locs$lon))
  y_coord <- c(min(locs$lat),max(locs$lat),max(locs$lat),min(locs$lat))
  xym <- cbind(x_coord, y_coord)
  p <- Polygon(xym)
  ps = Polygons(list(p),-1)
  sps = SpatialPolygons(list(ps))
  proj4string(sps) = CRS(WGS84)
  sps <- spTransform(sps, BEL)
  Rivieren2 <- Rivieren
  proj4string(Rivieren2) = CRS(WGS84)
  Rivieren2 <- spTransform(Rivieren2, BEL)
  clip <- gIntersection(Rivieren2, sps, byid = TRUE, drop_lower_td = TRUE)
  Rivierlengtes$Lengte[Rivierlengtes$Bever==i] <- gLength(clip)
}
```

```{r Tabhomeranges}
TabelHR <- merge(Oppervlaktes,Rivierlengtes, by.x="id", by.y="Bever") %>% 
  mutate(area = round(area,2)) %>% 
  mutate(Lengte = round(Lengte/1000,2))

kable(TabelHR,
  caption = "Overzicht home range groottes per bever.",
  col.names = c("Bever", "Oppervlakte (95%MCP) (ha)", "Oeverlengte (km)")
 )
```

```{r TabhMeanders}
Meanderdata <- as.data.frame(HRdata@data)
Meanderdata$polygon_id <- Meanderdata$polygon_id$box_id
Meanderdata$meander <- 1
Meanderdata$meander[is.na(Meanderdata$polygon_id)] <- 0
library(lubridate)
Meanderdata$Maand <- month(Meanderdata$Datumkort)

TabelMeanders <- Meanderdata %>%
  group_by(Maand) %>% 
  summarise(waarnemingen = length(Bever), InMeander = sum(meander), Aandeel =
              InMeander/waarnemingen*100) 

kable(TabelMeanders,
  caption = "Overzicht waarnemingen binnen en buiten meanders.",
  col.names = c("Maand", "Aantal waarnemingen", "Binnen meander", "Aandeel")
 )
```