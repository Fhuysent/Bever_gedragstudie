```{r libraries}
library(RSQLite)
library(tidyverse)
```

```{r read data}
rteu_54_database <- untar("./Lokeren/Input/Masten/2024-02-28_14-58-53_rteu-54.db.tar.gz", 
                          list = TRUE)

con <- dbConnect(RSQLite::SQLite(), rteu_54_database)

tables <- dbListTables(con)

rawdata <- dbGetQuery(con, "SELECT * FROM signals")
```

```{r filter data}
freqs <- c(151050, 151150)

for(f in freqs){
  
  f_min <- f-2
  f_max <- f+2
  
  filtered_data <- rawdata %>% 
    filter(signal_freq >= f_min & signal_freq <= f_max) %>% 
    mutate(datetime = parse_datetime(timestamp),
           time = format(datetime, "%H:%M"),
           hour = hour(datetime))
  
  summary(as.Date(filtered_data$timestamp))
  
  assign(paste0("d_", f), filtered_data)
}
```

```{r}
summary(as.Date(d_151050$timestamp))
table(as.Date(d_151050$timestamp))
summary(as.Date(d_151150$timestamp))
table(as.Date(d_151150$timestamp))

ggplot(d_151050, aes(x = time)) +
  geom_histogram(stat = "count")

ggplot(d_151050, aes(x = hour)) +
  geom_histogram(stat = "count")

ggplot(d_151150, aes(x = time)) +
  geom_histogram(stat = "count")

ggplot(d_151150, aes(x = hour)) +
  geom_histogram(stat = "count")
```

